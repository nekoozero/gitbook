
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>AQS · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../Basic/" />
    
    
    <link rel="prev" href="等待-通知机制.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    前言
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../JVM/">
            
                <a href="../JVM/">
            
                    
                    JVM
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../JVM/Java内存区域与内存溢出.html">
            
                <a href="../JVM/Java内存区域与内存溢出.html">
            
                    
                    Java内存区域与内存溢出
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../JVM/类变量和Class对象存放的区域.html">
            
                <a href="../JVM/类变量和Class对象存放的区域.html">
            
                    
                    类变量和Class对象存放的区域
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../JVM/TLAB.html">
            
                <a href="../JVM/TLAB.html">
            
                    
                    TLAB
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../JVM/内存分配与回收策略.html">
            
                <a href="../JVM/内存分配与回收策略.html">
            
                    
                    内存分配与回收策略
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../JVM/HotSpot对象.html">
            
                <a href="../JVM/HotSpot对象.html">
            
                    
                    HotSpot对象
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../JVM/对象存活和引用.html">
            
                <a href="../JVM/对象存活和引用.html">
            
                    
                    对象存活和引用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../JVM/垃圾算法细节名词.html">
            
                <a href="../JVM/垃圾算法细节名词.html">
            
                    
                    垃圾算法细节名词
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../JVM/经典垃圾收集器.html">
            
                <a href="../JVM/经典垃圾收集器.html">
            
                    
                    经典垃圾收集器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../JVM/类加载器.html">
            
                <a href="../JVM/类加载器.html">
            
                    
                    类加载器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../JVM/类加载机制.html">
            
                <a href="../JVM/类加载机制.html">
            
                    
                    类加载机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../JVM/JVM中的编译器与解释器.html">
            
                <a href="../JVM/JVM中的编译器与解释器.html">
            
                    
                    HotSpot中的编译器与解释器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../JVM/JIT部分优化措施.html">
            
                <a href="../JVM/JIT部分优化措施.html">
            
                    
                    JIT部分优化措施
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    多线程
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="JMM.html">
            
                <a href="JMM.html">
            
                    
                    JMM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="线程安全的实现.html">
            
                <a href="线程安全的实现.html">
            
                    
                    线程安全的实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="volatile.html">
            
                <a href="volatile.html">
            
                    
                    volatile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="synchronized.html">
            
                <a href="synchronized.html">
            
                    
                    synchronized
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="锁优化.html">
            
                <a href="锁优化.html">
            
                    
                    锁优化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="CAS.html">
            
                <a href="CAS.html">
            
                    
                    CAS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="JUC常用并发工具类.html">
            
                <a href="JUC常用并发工具类.html">
            
                    
                    JUC常用并发工具类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="线程中断.html">
            
                <a href="线程中断.html">
            
                    
                    线程中断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="ThreadLocal基础.html">
            
                <a href="ThreadLocal基础.html">
            
                    
                    ThreadLocal基础
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.10" data-path="等待-通知机制.html">
            
                <a href="等待-通知机制.html">
            
                    
                    等待-通知机制
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.11" data-path="AQS.html">
            
                <a href="AQS.html">
            
                    
                    AQS
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../Basic/">
            
                <a href="../Basic/">
            
                    
                    基础/高级
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../Basic/java中的序列化.html">
            
                <a href="../Basic/java中的序列化.html">
            
                    
                    java中的序列化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../Basic/反射.html">
            
                <a href="../Basic/反射.html">
            
                    
                    反射
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../Basic/动态代理.html">
            
                <a href="../Basic/动态代理.html">
            
                    
                    动态代理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../Basic/函数式编程.html">
            
                <a href="../Basic/函数式编程.html">
            
                    
                    函数式编程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../Basic/stream.html">
            
                <a href="../Basic/stream.html">
            
                    
                    stream流
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../Basic/父子类中的初始化顺序.html">
            
                <a href="../Basic/父子类中的初始化顺序.html">
            
                    
                    父子类中的初始化顺序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../Basic/值传递和引用传递.html">
            
                <a href="../Basic/值传递和引用传递.html">
            
                    
                    值传递还是引用传递
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../Basic/单例模式.html">
            
                <a href="../Basic/单例模式.html">
            
                    
                    单例模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../Basic/接口和抽象类.html">
            
                <a href="../Basic/接口和抽象类.html">
            
                    
                    接口和抽象类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../Basic/ConcurrentHashMap.html">
            
                <a href="../Basic/ConcurrentHashMap.html">
            
                    
                    ConcurrentHashMap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../Basic/SPI.html">
            
                <a href="../Basic/SPI.html">
            
                    
                    SPI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../Basic/位运算.html">
            
                <a href="../Basic/位运算.html">
            
                    
                    位运算
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../Spring/">
            
                <a href="../Spring/">
            
                    
                    Spring
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../Spring/Spring 中的 ApplicationListener.html">
            
                <a href="../Spring/Spring 中的 ApplicationListener.html">
            
                    
                    Spring 中的 ApplicationListener
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../Spring/理解ApplicationListener.html">
            
                <a href="../Spring/理解ApplicationListener.html">
            
                    
                    理解ApplicationListener
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../Spring/BeanPostProcessor.html">
            
                <a href="../Spring/BeanPostProcessor.html">
            
                    
                    BeanPostProcessor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../Spring/BeanDefinition.html">
            
                <a href="../Spring/BeanDefinition.html">
            
                    
                    BeanDefinition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../Spring/BeanFactory.html">
            
                <a href="../Spring/BeanFactory.html">
            
                    
                    BeanFactory
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="../Spring/Spring中的扩展.html">
            
                <a href="../Spring/Spring中的扩展.html">
            
                    
                    Spring中的扩展
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="../Spring/BeanFactory基础设施.html">
            
                <a href="../Spring/BeanFactory基础设施.html">
            
                    
                    BeanFactory基础设施
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../Daily/">
            
                <a href="../Daily/">
            
                    
                    日常记录
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../Daily/Spring Boot异常处理RestControllerAdvice.html">
            
                <a href="../Daily/Spring Boot异常处理RestControllerAdvice.html">
            
                    
                    Spring Boot异常处理RestControllerAdvice
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../Daily/Spring-boot常用配置.html">
            
                <a href="../Daily/Spring-boot常用配置.html">
            
                    
                    Spring-boot常用配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="../Daily/token的简单使用.html">
            
                <a href="../Daily/token的简单使用.html">
            
                    
                    token的简单使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="../Daily/swagger2.html">
            
                <a href="../Daily/swagger2.html">
            
                    
                    swagger2
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.5" data-path="../Daily/CountDownLatch的一次使用.html">
            
                <a href="../Daily/CountDownLatch的一次使用.html">
            
                    
                    CountDownLatch的一次使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.6" data-path="../Daily/nacos集群安装.html">
            
                <a href="../Daily/nacos集群安装.html">
            
                    
                    nacos集群安装
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../My/">
            
                <a href="../My/">
            
                    
                    原创
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../My/HashMap容量问题.html">
            
                <a href="../My/HashMap容量问题.html">
            
                    
                    HashMap容量问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../My/HashMap的容量问题2-0.html">
            
                <a href="../My/HashMap的容量问题2-0.html">
            
                    
                    HashMap的容量问题2-0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../My/三元运算符的 NPE.html">
            
                <a href="../My/三元运算符的 NPE.html">
            
                    
                    三元运算符的 NPE
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../My/HashMap扩容时是否hash.html">
            
                <a href="../My/HashMap扩容时是否hash.html">
            
                    
                    HashMap扩容时是否hash
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.5" data-path="../My/Spring Aop的两个问题.html">
            
                <a href="../My/Spring Aop的两个问题.html">
            
                    
                    Spring AOP的两个问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.6" data-path="../My/ThreadLocal相关.html">
            
                <a href="../My/ThreadLocal相关.html">
            
                    
                    ThreadLocal相关
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../Docker/">
            
                <a href="../Docker/">
            
                    
                    Docker
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../Docker/Docker.html">
            
                <a href="../Docker/Docker.html">
            
                    
                    Docker总记
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../Docker/docker-install.html">
            
                <a href="../Docker/docker-install.html">
            
                    
                    Docker安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../Docker/docker-mysql.html">
            
                <a href="../Docker/docker-mysql.html">
            
                    
                    安装mysql
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../Docker/jenkins的坑.html">
            
                <a href="../Docker/jenkins的坑.html">
            
                    
                    jenkins的部分坑
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../Linux/">
            
                <a href="../Linux/">
            
                    
                    Linux
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../Linux/Linux虚拟机VM网络配置.html">
            
                <a href="../Linux/Linux虚拟机VM网络配置.html">
            
                    
                    Linux虚拟机VM网络配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="../Linux/vi和vim.html">
            
                <a href="../Linux/vi和vim.html">
            
                    
                    vi和vim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="../Linux/Linux目录.html">
            
                <a href="../Linux/Linux目录.html">
            
                    
                    Linux目录
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.4" data-path="../Linux/用户.html">
            
                <a href="../Linux/用户.html">
            
                    
                    用户
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.5" data-path="../Linux/指令.html">
            
                <a href="../Linux/指令.html">
            
                    
                    指令
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.6" data-path="../Linux/任务调度.html">
            
                <a href="../Linux/任务调度.html">
            
                    
                    任务调度
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.7" data-path="../Linux/磁盘分区、挂载.html">
            
                <a href="../Linux/磁盘分区、挂载.html">
            
                    
                    磁盘分区、挂载
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.8" data-path="../Linux/磁盘情况查询.html">
            
                <a href="../Linux/磁盘情况查询.html">
            
                    
                    磁盘情况查询
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.9" data-path="../Linux/安装iptables.html">
            
                <a href="../Linux/安装iptables.html">
            
                    
                    安装iptables
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.10" data-path="../Linux/rpm 和 yum.html">
            
                <a href="../Linux/rpm 和 yum.html">
            
                    
                    rpm 和 yum
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.11" data-path="../Linux/动态监控进程.html">
            
                <a href="../Linux/动态监控进程.html">
            
                    
                    动态监控进程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.12" data-path="../Linux/进程管理.html">
            
                <a href="../Linux/进程管理.html">
            
                    
                    进程管理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.13" data-path="../Linux/常用软件.html">
            
                <a href="../Linux/常用软件.html">
            
                    
                    常用软件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.14" data-path="../Linux/Shell运算符与条件判断.html">
            
                <a href="../Linux/Shell运算符与条件判断.html">
            
                    
                    Shell运算符与条件判断
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.15" data-path="../Linux/Shell 读取控制台输入.html">
            
                <a href="../Linux/Shell 读取控制台输入.html">
            
                    
                    Shell 读取控制台输入
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.16" data-path="../Linux/shell 综合案例.html">
            
                <a href="../Linux/shell 综合案例.html">
            
                    
                    shell 综合案例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.17" data-path="../Linux/Shell.html">
            
                <a href="../Linux/Shell.html">
            
                    
                    Shell
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.18" data-path="../Linux/网络配置.html">
            
                <a href="../Linux/网络配置.html">
            
                    
                    网络配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.19" data-path="../Linux/日常使用记录.html">
            
                <a href="../Linux/日常使用记录.html">
            
                    
                    日常使用记录
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../Http/">
            
                <a href="../Http/">
            
                    
                    网络、计算机、操作系统
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.10.1" data-path="../Http/网络基础 TCP-IP.html">
            
                <a href="../Http/网络基础 TCP-IP.html">
            
                    
                    网络基础 TCP/IP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.2" data-path="../Http/IP.html">
            
                <a href="../Http/IP.html">
            
                    
                    IP、TCP、DNS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.3" data-path="../Http/HTTP通信.html">
            
                <a href="../Http/HTTP通信.html">
            
                    
                    HTTP通信
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.4" data-path="../Http/HTTP报文内的HTTP信息.html">
            
                <a href="../Http/HTTP报文内的HTTP信息.html">
            
                    
                    HTTP报文内的HTTP信息
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.5" data-path="../Http/操作系统简介.html">
            
                <a href="../Http/操作系统简介.html">
            
                    
                    操作系统简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.6" data-path="../Http/CPU简介.html">
            
                <a href="../Http/CPU简介.html">
            
                    
                    CPU简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.7" data-path="../Http/内存简介.html">
            
                <a href="../Http/内存简介.html">
            
                    
                    内存简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.8" data-path="../Http/IO简介.html">
            
                <a href="../Http/IO简介.html">
            
                    
                    IO简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10.9" data-path="../Http/总线简介.html">
            
                <a href="../Http/总线简介.html">
            
                    
                    总线简介
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="../Design/">
            
                <a href="../Design/">
            
                    
                    设计模式
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.1" data-path="../Design/23种设计模式.html">
            
                <a href="../Design/23种设计模式.html">
            
                    
                    23种设计模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.2" data-path="../Design/UML和类之间的关系.html">
            
                <a href="../Design/UML和类之间的关系.html">
            
                    
                    UML和类之间的关系
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.3" data-path="../Design/七大原则.html">
            
                <a href="../Design/七大原则.html">
            
                    
                    七大原则
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.4" data-path="../Design/单例模式.html">
            
                <a href="../Design/单例模式.html">
            
                    
                    单例模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.5" data-path="../Design/原型模式.html">
            
                <a href="../Design/原型模式.html">
            
                    
                    原型模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.6" data-path="../Design/工厂方法模式.html">
            
                <a href="../Design/工厂方法模式.html">
            
                    
                    工厂方法模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.7" data-path="../Design/策略模式.html">
            
                <a href="../Design/策略模式.html">
            
                    
                    策略模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.8" data-path="../Design/装饰者模式.html">
            
                <a href="../Design/装饰者模式.html">
            
                    
                    装饰者模式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9" data-path="../Design/Geek/">
            
                <a href="../Design/Geek/">
            
                    
                    Geek
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.11.9.1" data-path="../Design/Geek/面向过程示例.html">
            
                <a href="../Design/Geek/面向过程示例.html">
            
                    
                    面向过程
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9.2" data-path="../Design/Geek/接口与抽象类.html">
            
                <a href="../Design/Geek/接口与抽象类.html">
            
                    
                    接口与抽象类
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9.3" data-path="../Design/Geek/基于接口而非实现.html">
            
                <a href="../Design/Geek/基于接口而非实现.html">
            
                    
                    基于接口而非实现
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9.4" data-path="../Design/Geek/多用组合少用继承.html">
            
                <a href="../Design/Geek/多用组合少用继承.html">
            
                    
                    多用组合少用继承
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9.5" data-path="../Design/Geek/贫血模型与充血模型.html">
            
                <a href="../Design/Geek/贫血模型与充血模型.html">
            
                    
                    贫血模型与充血模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11.9.6" data-path="../Design/Geek/单一职责原则.html">
            
                <a href="../Design/Geek/单一职责原则.html">
            
                    
                    单一职责原则
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="../Effective/">
            
                <a href="../Effective/">
            
                    
                    Effective Java
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="../Effective/创建和销毁对象.html">
            
                <a href="../Effective/创建和销毁对象.html">
            
                    
                    第一章：创建和销毁对象
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12.2" data-path="../Effective/通用方法.html">
            
                <a href="../Effective/通用方法.html">
            
                    
                    第二章：对于所有对象都通用的方法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="../Netty/">
            
                <a href="../Netty/">
            
                    
                    Netty
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.13.1" data-path="../Netty/IO 模型.html">
            
                <a href="../Netty/IO 模型.html">
            
                    
                    BIO
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.2" data-path="../Netty/NIO基本介绍.html">
            
                <a href="../Netty/NIO基本介绍.html">
            
                    
                    NIO基本介绍
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.3" data-path="../Netty/Buffer和Channel.html">
            
                <a href="../Netty/Buffer和Channel.html">
            
                    
                    Buffer和Channel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.4" data-path="../Netty/Selector.html">
            
                <a href="../Netty/Selector.html">
            
                    
                    Selector
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.5" data-path="../Netty/NIO与零拷贝.html">
            
                <a href="../Netty/NIO与零拷贝.html">
            
                    
                    NIO与零拷贝
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.6" data-path="../Netty/各种服务模型.html">
            
                <a href="../Netty/各种服务模型.html">
            
                    
                    各种服务模型
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13.7" data-path="../Netty/nio 与 netty 的简单示例.html">
            
                <a href="../Netty/nio 与 netty 的简单示例.html">
            
                    
                    nio 与 netty 的简单示例
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="../Data-structure-algorithm/">
            
                <a href="../Data-structure-algorithm/">
            
                    
                    data-structure-algorithm
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.14.1" data-path="../Data-structure-algorithm/数组和链表.html">
            
                <a href="../Data-structure-algorithm/数组和链表.html">
            
                    
                    数组和链表
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.2" data-path="../Data-structure-algorithm/LRU缓存淘汰算法.html">
            
                <a href="../Data-structure-algorithm/LRU缓存淘汰算法.html">
            
                    
                    LRU缓存淘汰算法
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14.3" data-path="../Data-structure-algorithm/字符串匹配算法.html">
            
                <a href="../Data-structure-algorithm/字符串匹配算法.html">
            
                    
                    字符串匹配算法
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="../Other/">
            
                <a href="../Other/">
            
                    
                    其他
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.15.1" data-path="../Other/遇到的问题.html">
            
                <a href="../Other/遇到的问题.html">
            
                    
                    遇到的问题
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.2" data-path="../Other/js引入静态文件.html">
            
                <a href="../Other/js引入静态文件.html">
            
                    
                    js引入静态文件
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15.3" data-path="../Other/centos-mysql.html">
            
                <a href="../Other/centos-mysql.html">
            
                    
                    centos-mysql
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >AQS</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="aqs">AQS</h1>
<blockquote>
<p>&#x65F6;&#x95F4; 2020/5/9</p>
</blockquote>
<p>&#x9996;&#x5148;&#x8FD8;&#x662F;&#x770B;&#x4E00;&#x4E0B;&#x6E90;&#x7801;&#x4E2D;&#x7684;&#x6CE8;&#x91CA;</p>
<pre><code>Provides a framework for implementing blocking locks and related synchronizers (semaphores, events, etc) that rely on first-in-first-out (FIFO) wait queues.  This class is designed to be a useful basis for most kinds of synchronizers that rely on a single atomic {@code int state} value to represent state. Subclasses must define the protected methods that change this state, and which define what that state means in terms of this object being acquired or released.  Given these, the other methods in this class carry out all queuing and blocking mechanics. Subclasses can maintain other state fields, but only the atomically updated {@code int state} value manipulated using methods {@link #getState}, {@link #setState} and {@link #compareAndSetState} is tracked with respect to synchronization.

Subclasses should be defined as non-public internal helper classes that are used to implement the synchronization properties of their enclosing class.  Class {@code AbstractQueuedSynchronizer} does not implement any synchronization interface.  Instead it defines methods such as {@link #acquireInterruptibly} that can be invoked as appropriate by concrete locks and related synchronizers to implement their public methods.

This class supports either or both a default &lt;em&gt;exclusive&lt;/em&gt; mode and a &lt;em&gt;shared&lt;/em&gt; mode. When acquired in exclusive mode,attempted acquires by other threads cannot succeed. Shared mode acquires by multiple threads may (but need not) succeed. This class does not &amp;quot;understand&amp;quot; these differences except in the mechanical sense that when a shared mode acquire succeeds, the next waiting thread (if one exists) must also determine whether it can acquire as well. Threads waiting in the different modes share the same FIFO queue. Usually, implementation subclasses support only one of these modes, but both can come into play for example in a {@link ReadWriteLock}. Subclasses that support only exclusive or only shared modes need not define the methods supporting the unused mode.

This class defines a nested {@link ConditionObject} class that can be used as a {@link Condition} implementation by subclasses supporting exclusive mode for which method {@link  #isHeldExclusively} reports whether synchronization is exclusively held with respect to the current thread, method {@link #release} invoked with the current {@link #getState} value fully releases this object, and {@link #acquire }, given this saved state value,eventually restores this object to its previous acquired state.  No {@code AbstractQueuedSynchronizer} method otherwise creates such a condition, so if this constraint cannot be met, do not use it.  The behavior of {@link ConditionObject} depends of course on the semantics of its synchronizer implementation.

This class provides inspection, instrumentation, and monitoring methods for the internal queue, as well as similar methods for condition objects. These can be exported as desired into classes using an {@code AbstractQueuedSynchronizer} for their synchronization mechanics.
Serialization of this class stores only the underlying atomic integer maintaining state, so deserialized objects have empty thread queues. Typical subclasses requiring serializability will define a {@code readObject} method that restores this to a known initial state upon deserialization.

 Usage

To use this class as the basis of a synchronizer, redefine the following methods, as applicable, by inspecting and/or modifying the synchronization state using {@link #getState}, {@link #setState} and/or {@link #compareAndSetState}:


  {@link #tryAcquire}
  {@link #tryRelease}
  {@link #tryAcquireShared}
  {@link #tryReleaseShared}
  {@link #isHeldExclusively}


Each of these methods by default throws {@link UnsupportedOperationException}.  Implementations of these methods must be internally thread-safe, and should in general be short and not block. Defining these methods is the &lt;em&gt;only&lt;/em&gt; supported means of using this class. All other methods are declared {@code final} because they cannot be independently varied.

You may also find the inherited methods from {@link AbstractOwnableSynchronizer} useful to keep track of the thread owning an exclusive synchronizer.  You are encouraged to use them -- this enables monitoring and diagnostic tools to assist users in determining which threads hold locks.

Even though this class is based on an internal FIFO queue, it does not automatically enforce FIFO acquisition policies.  The core of exclusive synchronization takes the form:


 * Acquire:
 *     while (!tryAcquire(arg)) {
 *        &lt;em&gt;enqueue thread if it is not already queued&lt;/em&gt;;
 *        &lt;em&gt;possibly block current thread&lt;/em&gt;;
 *     }
 *
 * Release:
 *     if (tryRelease(arg))
 *        &lt;em&gt;unblock the first queued thread&lt;/em&gt;;


(Shared mode is similar but may involve cascading signals.)

Because checks in acquire are invoked before enqueuing, a newly acquiring thread may barge ahead of others that are blocked and queued.  However, you can, if desired,define {@code tryAcquire} and/or {@code tryAcquireShared} to disable barging by internally invoking one or more of the inspection methods, thereby providing a fair FIFO acquisition order.In particular, most fair synchronizers can define {@code tryAcquire} to return {@code false} if {@link #hasQueuedPredecessors} (a method specifically designed to be used by fair synchronizers) returns {@code true}.  Other variations are possible.

Throughput and scalability are generally highest for the default barging (also known as greedy,renouncement, and convoy-avoidance) strategy. While this is not guaranteed to be fair or starvation-free, earlier queued threads are allowed to recontend before later queued threads, and each recontention has an unbiased chance to succeed against incoming threads.  Also, while acquires do not &amp;quot;spin&amp;quot; in the usual sense, they may perform multiple invocations of {@code tryAcquire} interspersed with other computations before blocking.  This gives most of the benefits of spins when exclusive synchronization is only briefly held, without most of the liabilities when it isn&apos;t. If so desired, you can augment this by preceding calls to acquire methods with &quot;fast-path&quot; checks, possibly prechecking {@link #hasContended} and/or {@link #hasQueuedThreads} to only do so if the synchronizer is likely not to be contended.

This class provides an efficient and scalable basis for synchronization in part by specializing its range of use to synchronizers that can rely on {@code int} state, acquire, and release parameters, and an internal FIFO wait queue. When this does not suffice, you can build synchronizers from a lower level using {@link java.util.concurrent.atomic atomic} classes, your own custom {@link java.util.Queue} classes, and {@link LockSupport} blocking support.
</code></pre><p>&#x4E2D;&#x6587;&#xFF08;&#x4E4B;&#x540E;&#x4F1A;&#x5BF9;&#x7FFB;&#x8BD1;&#x4E0D;&#x597D;&#x7684;&#x5730;&#x65B9;&#x624B;&#x52A8;&#x7FFB;&#x8BD1;&#x4E00;&#x4E0B;&#xFF09;</p>
<pre><code>&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;&#x6846;&#x67B6;&#xFF0C;&#x7528;&#x4E8E;&#x5B9E;&#x73B0;&#x4F9D;&#x8D56;&#x4E8E;&#x5148;&#x8FDB;&#x5148;&#x51FA;&#xFF08;FIFO&#xFF09;&#x7B49;&#x5F85;&#x961F;&#x5217;&#x7684;&#x963B;&#x585E;&#x9501;&#x548C;&#x76F8;&#x5173;&#x7684;&#x540C;&#x6B65;&#x5668;&#xFF08;&#x4FE1;&#x53F7;&#x706F;&#xFF0C;&#x4E8B;&#x4EF6;&#x7B49;&#xFF09;&#x3002;&#x6B64;&#x7C7B;&#x65E8;&#x5728;&#x4E3A;&#x5927;&#x591A;&#x6570;&#x4F9D;&#x8D56;&#x5355;&#x4E2A;&#x539F;&#x5B50;{@code int state}&#x503C;&#x8868;&#x793A;&#x72B6;&#x6001;&#x7684;&#x540C;&#x6B65;&#x5668;&#x63D0;&#x4F9B;&#x6709;&#x7528;&#x7684;&#x57FA;&#x7840;&#x3002;&#x5B50;&#x7C7B;&#x5FC5;&#x987B;&#x5B9A;&#x4E49;&#x66F4;&#x6539;&#x6B64;&#x72B6;&#x6001;&#x7684;&#x53D7;&#x4FDD;&#x62A4;&#x65B9;&#x6CD5;&#xFF0C;&#x5E76;&#x5B9A;&#x4E49;&#x8BE5;&#x72B6;&#x6001;&#x5BF9;&#x4E8E;&#x83B7;&#x53D6;&#x6216;&#x91CA;&#x653E;&#x6B64;&#x5BF9;&#x8C61;&#x800C;&#x8A00;&#x610F;&#x5473;&#x7740;&#x4EC0;&#x4E48;&#x3002;&#x9274;&#x4E8E;&#x8FD9;&#x4E9B;&#xFF0C;&#x6B64;&#x7C7B;&#x4E2D;&#x7684;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x5C06;&#x6267;&#x884C;&#x6240;&#x6709;&#x6392;&#x961F;&#x548C;&#x963B;&#x585E;&#x673A;&#x5236;&#x3002;&#x5B50;&#x7C7B;&#x53EF;&#x4EE5;&#x7EF4;&#x62A4;&#x5176;&#x4ED6;&#x72B6;&#x6001;&#x5B57;&#x6BB5;&#xFF0C;&#x4F46;&#x662F;&#x4EC5;&#x8DDF;&#x8E2A;&#x5173;&#x4E8E;&#x540C;&#x6B65;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;{@link #getState}&#xFF0C;{@ link #setState}&#x548C;{@link #compareAndSetState}&#x64CD;&#x4F5C;&#x7684;&#x539F;&#x5B50;&#x66F4;&#x65B0;&#x7684;{@code int state}&#x503C;&#x3002;

&#x5B50;&#x7C7B;&#x5E94;&#x8BE5;&#x5B9A;&#x4E49;&#x4E3A;&#x7528;&#x4E8E;&#x5B9E;&#x73B0;&#x5176;&#x5C01;&#x95ED;&#x7C7B;&#x7684;&#x540C;&#x6B65;&#x5C5E;&#x6027;&#x7684;&#x975E;&#x516C;&#x5171;&#x5185;&#x90E8;&#x5E2E;&#x52A9;&#x5668;&#x7C7B;&#x3002;&#x7C7B;{@code AbstractQueuedSynchronizer}&#x6CA1;&#x6709;&#x5B9E;&#x73B0;&#x4EFB;&#x4F55;&#x540C;&#x6B65;&#x63A5;&#x53E3;&#x3002;&#x76F8;&#x53CD;&#xFF0C;&#x5B83;&#x5B9A;&#x4E49;&#x4E86;{@link #acquireInterruptible}&#x4E4B;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5177;&#x4F53;&#x7684;&#x9501;&#x548C;&#x76F8;&#x5173;&#x7684;&#x540C;&#x6B65;&#x5668;&#x9002;&#x5F53;&#x5730;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x6765;&#x5B9E;&#x73B0;&#x5176;&#x516C;&#x5171;&#x65B9;&#x6CD5;&#x3002;

&#x6B64;&#x7C7B;&#x652F;&#x6301;&#x9ED8;&#x8BA4;&#x6392;&#x4ED6;&#x6A21;&#x5F0F;&#x548C;&#x5171;&#x4EAB;&#x6A21;&#x5F0F;&#x4E4B;&#x4E00;&#x6216;&#x4E24;&#x8005;&#x3002;&#x5F53;&#x4EE5;&#x72EC;&#x5360;&#x6A21;&#x5F0F;&#x8FDB;&#x884C;&#x83B7;&#x53D6;&#x65F6;&#xFF0C;&#x5176;&#x4ED6;&#x7EBF;&#x7A0B;&#x5C1D;&#x8BD5;&#x8FDB;&#x884C;&#x7684;&#x83B7;&#x53D6;&#x5C06;&#x65E0;&#x6CD5;&#x6210;&#x529F;&#x3002;&#x7531;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x7684;&#x5171;&#x4EAB;&#x6A21;&#x5F0F;&#x53EF;&#x80FD;&#xFF08;&#x4F46;&#x4E0D;&#x4E00;&#x5B9A;&#xFF09;&#x6210;&#x529F;&#x3002;&#x8BE5;&#x7C7B;&#x4E0D;&#x7406;&#x89E3;&#x8FD9;&#x4E9B;&#x5DEE;&#x5F02;&#xFF0C;&#x53EA;&#x662F;&#x4ECE;&#x673A;&#x68B0;&#x610F;&#x4E49;&#x4E0A;&#x8BF4;&#xFF0C;&#x5F53;&#x6210;&#x529F;&#x83B7;&#x53D6;&#x5171;&#x4EAB;&#x6A21;&#x5F0F;&#x65F6;&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x7B49;&#x5F85;&#x7EBF;&#x7A0B;&#xFF08;&#x5982;&#x679C;&#x5B58;&#x5728;&#xFF09;&#x4E5F;&#x5FC5;&#x987B;&#x786E;&#x5B9A;&#x5B83;&#x662F;&#x5426;&#x4E5F;&#x53EF;&#x4EE5;&#x83B7;&#x53D6;&#x3002;&#x5728;&#x4E0D;&#x540C;&#x6A21;&#x5F0F;&#x4E0B;&#x7B49;&#x5F85;&#x7684;&#x7EBF;&#x7A0B;&#x5171;&#x4EAB;&#x76F8;&#x540C;&#x7684;FIFO&#x961F;&#x5217;&#x3002;&#x901A;&#x5E38;&#xFF0C;&#x5B9E;&#x73B0;&#x5B50;&#x7C7B;&#x4EC5;&#x652F;&#x6301;&#x8FD9;&#x4E9B;&#x6A21;&#x5F0F;&#x4E4B;&#x4E00;&#xFF0C;&#x4F46;&#x4F8B;&#x5982;&#x53EF;&#x4EE5;&#x5728;{@link ReadWriteLock}&#x4E2D;&#x53D1;&#x6325;&#x4F5C;&#x7528;&#x3002;&#x4EC5;&#x652F;&#x6301;&#x4E92;&#x65A5;&#x6A21;&#x5F0F;&#x6216;&#x4EC5;&#x652F;&#x6301;&#x5171;&#x4EAB;&#x6A21;&#x5F0F;&#x7684;&#x5B50;&#x7C7B;&#x65E0;&#x9700;&#x5B9A;&#x4E49;&#x652F;&#x6301;&#x672A;&#x4F7F;&#x7528;&#x6A21;&#x5F0F;&#x7684;&#x65B9;&#x6CD5;&#x3002;

&#x6B64;&#x7C7B;&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x5D4C;&#x5957;&#x7684;{@link ConditionObject}&#x7C7B;&#xFF0C;&#x8BE5;&#x7C7B;&#x53EF;&#x4EE5;&#x88AB;&#x652F;&#x6301;&#x72EC;&#x5360;&#x6A21;&#x5F0F;&#x7684;&#x5B50;&#x7C7B;&#x7528;&#x4F5C;{@link Condition}&#x5B9E;&#x73B0;&#xFF0C;&#x4E3A;&#x6B64;&#x65B9;&#x6CD5;{@link #isHeldExclusively}&#x62A5;&#x544A;&#x662F;&#x5426;&#x9488;&#x5BF9;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x4E13;&#x6709;&#x5730;&#x4FDD;&#x6301;&#x540C;&#x6B65;&#xFF0C;&#x4F7F;&#x7528;&#x5F53;&#x524D;{@link #getState}&#x503C;&#x8C03;&#x7528;&#x7684;&#x65B9;&#x6CD5;{@link #release}&#x4F1A;&#x5B8C;&#x5168;&#x91CA;&#x653E;&#x6B64;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;&#x7ED9;&#x5B9A;&#x5DF2;&#x4FDD;&#x5B58;&#x7684;&#x72B6;&#x6001;&#x503C;&#xFF0C;{@ link #acquire}&#x6700;&#x7EC8;&#x4F1A;&#x5C06;&#x6B64;&#x5BF9;&#x8C61;&#x6062;&#x590D;&#x4E3A;&#x5176;&#x5148;&#x524D;&#x83B7;&#x53D6;&#x7684;&#x72B6;&#x6001;&#x3002;&#x5426;&#x5219;&#xFF0C;&#x6CA1;&#x6709;{@code AbstractQueuedSynchronizer}&#x65B9;&#x6CD5;&#x4F1A;&#x521B;&#x5EFA;&#x8FD9;&#x6837;&#x7684;&#x6761;&#x4EF6;&#xFF0C;&#x56E0;&#x6B64;&#xFF0C;&#x5982;&#x679C;&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x6B64;&#x7EA6;&#x675F;&#xFF0C;&#x8BF7;&#x4E0D;&#x8981;&#x4F7F;&#x7528;&#x5B83;&#x3002; {@link ConditionObject}&#x7684;&#x884C;&#x4E3A;&#x5F53;&#x7136;&#x53D6;&#x51B3;&#x4E8E;&#x5176;&#x540C;&#x6B65;&#x5668;&#x5B9E;&#x73B0;&#x7684;&#x8BED;&#x4E49;&#x3002;

&#x6B64;&#x7C7B;&#x63D0;&#x4F9B;&#x4E86;&#x5185;&#x90E8;&#x961F;&#x5217;&#x7684;&#x68C0;&#x67E5;&#xFF0C;&#x68C0;&#x6D4B;&#x548C;&#x76D1;&#x89C6;&#x65B9;&#x6CD5;&#xFF0C;&#x4EE5;&#x53CA;&#x6761;&#x4EF6;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x4F3C;&#x65B9;&#x6CD5;&#x3002;&#x53EF;&#x4EE5;&#x6839;&#x636E;&#x9700;&#x8981;&#x4F7F;&#x7528;{@code AbstractQueuedSynchronizer}&#x5C06;&#x5B83;&#x4EEC;&#x5BFC;&#x51FA;&#x5230;&#x7C7B;&#x4E2D;&#x4EE5;&#x5B9E;&#x73B0;&#x5176;&#x540C;&#x6B65;&#x673A;&#x5236;&#x3002;
&#x6B64;&#x7C7B;&#x7684;&#x5E8F;&#x5217;&#x5316;&#x4EC5;&#x5B58;&#x50A8;&#x57FA;&#x7840;&#x539F;&#x5B50;&#x6574;&#x6570;&#x7EF4;&#x62A4;&#x72B6;&#x6001;&#xFF0C;&#x56E0;&#x6B64;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5BF9;&#x8C61;&#x5177;&#x6709;&#x7A7A;&#x7EBF;&#x7A0B;&#x961F;&#x5217;&#x3002;&#x9700;&#x8981;&#x53EF;&#x5E8F;&#x5217;&#x5316;&#x7684;&#x5178;&#x578B;&#x5B50;&#x7C7B;&#x5C06;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;{@code readObject}&#x65B9;&#x6CD5;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x53EF;&#x5728;&#x53CD;&#x5E8F;&#x5217;&#x5316;&#x65F6;&#x5C06;&#x5176;&#x6062;&#x590D;&#x4E3A;&#x5DF2;&#x77E5;&#x7684;&#x521D;&#x59CB;&#x72B6;&#x6001;&#x3002;

 &#x7528;&#x6CD5;

&#x8981;&#x5C06;&#x6B64;&#x7C7B;&#x7528;&#x4F5C;&#x540C;&#x6B65;&#x5668;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;{@link #getState}&#xFF0C;{@ link #setState}&#x548C;/&#x6216;{@link #compareAndSetState&#x68C0;&#x67E5;&#x548C;/&#x6216;&#x4FEE;&#x6539;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x91CD;&#x65B0;&#x5B9A;&#x4E49;&#x4EE5;&#x4E0B;&#x65B9;&#x6CD5;&#xFF08;&#x5982;&#x9002;&#x7528;&#xFF09; }&#xFF1A;

  {@link #tryAcquire}
  {@link #tryRelease}
  {@link #tryAcquireShared}
  {@link #tryReleaseShared}
  {@link #isHeldExclusively}


&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A;&#x90FD;&#x4F1A;&#x5F15;&#x53D1;{@link UnsupportedOperationException}&#x3002;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x5FC5;&#x987B;&#x5728;&#x5185;&#x90E8;&#x662F;&#x7EBF;&#x7A0B;&#x5B89;&#x5168;&#x7684;&#xFF0C;&#x5E76;&#x4E14;&#x901A;&#x5E38;&#x5E94;&#x7B80;&#x77ED;&#x4E14;&#x4E0D;&#x963B;&#x585E;&#x3002;&#x5B9A;&#x4E49;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x662F;&lt;em&gt; only &lt;/ em&gt;&#x652F;&#x6301;&#x7684;&#x4F7F;&#x7528;&#x6B64;&#x7C7B;&#x7684;&#x65B9;&#x6CD5;&#x3002;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x65B9;&#x6CD5;&#x90FD;&#x58F0;&#x660E;&#x4E3A;{@code final}&#xFF0C;&#x56E0;&#x4E3A;&#x5B83;&#x4EEC;&#x4E0D;&#x80FD;&#x72EC;&#x7ACB;&#x53D8;&#x5316;&#x3002;

&#x60A8;&#x53EF;&#x80FD;&#x8FD8;&#x4F1A;&#x53D1;&#x73B0;&#x4ECE;{@link AbstractOwnableSynchronizer}&#x7EE7;&#x627F;&#x7684;&#x65B9;&#x6CD5;&#x5BF9;&#x4E8E;&#x8DDF;&#x8E2A;&#x62E5;&#x6709;&#x72EC;&#x5360;&#x540C;&#x6B65;&#x5668;&#x7684;&#x7EBF;&#x7A0B;&#x5F88;&#x6709;&#x7528;&#x3002;&#x9F13;&#x52B1;&#x60A8;&#x4F7F;&#x7528;&#x5B83;&#x4EEC;-&#x8FD9;&#x5C06;&#x542F;&#x7528;&#x76D1;&#x89C6;&#x548C;&#x8BCA;&#x65AD;&#x5DE5;&#x5177;&#xFF0C;&#x4EE5;&#x5E2E;&#x52A9;&#x7528;&#x6237;&#x786E;&#x5B9A;&#x54EA;&#x4E9B;&#x7EBF;&#x7A0B;&#x6301;&#x6709;&#x9501;&#x3002;

&#x5373;&#x4F7F;&#x6B64;&#x7C7B;&#x57FA;&#x4E8E;&#x5185;&#x90E8;FIFO&#x961F;&#x5217;&#xFF0C;&#x5B83;&#x4E5F;&#x4E0D;&#x4F1A;&#x81EA;&#x52A8;&#x6267;&#x884C;FIFO&#x83B7;&#x53D6;&#x7B56;&#x7565;&#x3002;&#x72EC;&#x5360;&#x540C;&#x6B65;&#x7684;&#x6838;&#x5FC3;&#x91C7;&#x53D6;&#x4EE5;&#x4E0B;&#x5F62;&#x5F0F;&#xFF1A;
 * Acquire:
 *     while (!tryAcquire(arg)) {
 *        &lt;em&gt;&#x5982;&#x679C;&#x7EBF;&#x7A0B;&#x5C1A;&#x672A;&#x8FDB;&#x884C;&#x6392;&#x961F;&#xFF0C;&#x5219;&#x5BF9;&#x5176;&#x8FDB;&#x884C;&#x6392;&#x961F;&lt;/em&gt;;
 *        &lt;em&gt;&#x53EF;&#x80FD;&#x963B;&#x585E;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&lt;/em&gt;;
 *     }
 *
 * Release:
 *     if (tryRelease(arg))
 *        &lt;em&gt;&#x89E3;&#x9664;&#x7B2C;&#x4E00;&#x4E2A;&#x6392;&#x961F;&#x7EBF;&#x7A0B;&#x7684;&#x963B;&#x585E;&lt;/em&gt;;

 &#xFF08;&#x5171;&#x4EAB;&#x6A21;&#x5F0F;&#x76F8;&#x4F3C;&#xFF0C;&#x4F46;&#x53EF;&#x80FD;&#x6D89;&#x53CA;&#x7EA7;&#x8054;&#x4FE1;&#x53F7;&#x3002;&#xFF09;

&#x56E0;&#x4E3A;&#x83B7;&#x53D6;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x83B7;&#x53D6;&#x68C0;&#x67E5;&#x662F;&#x5728;&#x6392;&#x961F;&#x4E4B;&#x524D;&#x88AB;&#x8C03;&#x7528;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x65B0;&#x83B7;&#x53D6;&#x7EBF;&#x7A0B;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x5176;&#x4ED6;&#x88AB;&#x963B;&#x585E;&#x548C;&#x6392;&#x961F;&#x7684;&#x7EBF;&#x7A0B;&#x4E4B;&#x524D;&#x8FDB;&#x884C;&#x63D2;&#x5165;&#x3002;&#x4F46;&#x662F;&#xFF0C;&#x5982;&#x679C;&#x9700;&#x8981;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;{@code tryAcquire}&#x548C;/&#x6216;{@code tryAcquireShared}&#x4EE5;&#x901A;&#x8FC7;&#x5185;&#x90E8;&#x8C03;&#x7528;&#x4E00;&#x79CD;&#x6216;&#x591A;&#x79CD;&#x68C0;&#x67E5;&#x65B9;&#x6CD5;&#x6765;&#x7981;&#x7528;&#x63D2;&#x5165;&#xFF0C;&#x4ECE;&#x800C;&#x63D0;&#x4F9B;&#x516C;&#x5E73;&#x7684;FIFO&#x83B7;&#x53D6;&#x987A;&#x5E8F;&#x3002;&#x5C24;&#x5176;&#x662F;&#x5927;&#x591A;&#x6570;&#x516C;&#x5E73;&#x7684;&#x540C;&#x6B65;&#x5668;&#x5982;&#x679C;{@link #hasQueuedPredecessors}&#xFF08;&#x4E00;&#x79CD;&#x4E13;&#x95E8;&#x8BBE;&#x8BA1;&#x7528;&#x4E8E;&#x516C;&#x5E73;&#x540C;&#x6B65;&#x5668;&#x7684;&#x65B9;&#x6CD5;&#xFF09;&#x8FD4;&#x56DE;{@code true}&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;{@code tryAcquire}&#x4EE5;&#x8FD4;&#x56DE;{@code false}&#x3002;&#x5176;&#x4ED6;&#x53D8;&#x5316;&#x4E5F;&#x662F;&#x53EF;&#x80FD;&#x7684;&#x3002;

&#x5BF9;&#x4E8E;&#x9ED8;&#x8BA4;&#x63D2;&#x5165;&#xFF08;&#x4E5F;&#x79F0;&#x4E3A;&#x8D2A;&#x5A6A;&#xFF0C;&#x653E;&#x5F03;&#x548C;&#x907F;&#x514D;&#x901A;&#x4FE1;&#xFF09;&#x7B56;&#x7565;&#xFF0C;&#x541E;&#x5410;&#x91CF;&#x548C;&#x53EF;&#x4F38;&#x7F29;&#x6027;&#x901A;&#x5E38;&#x6700;&#x9AD8;&#x3002;&#x5C3D;&#x7BA1;&#x4E0D;&#x80FD;&#x4FDD;&#x8BC1;&#x8FD9;&#x662F;&#x516C;&#x5E73;&#x7684;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x9965;&#x997F;&#x73B0;&#x8C61;&#xFF0C;&#x4F46;&#x662F;&#x53EF;&#x4EE5;&#x8BA9;&#x8F83;&#x65E9;&#x6392;&#x961F;&#x7684;&#x7EBF;&#x7A0B;&#x5728;&#x8F83;&#x665A;&#x6392;&#x961F;&#x7684;&#x7EBF;&#x7A0B;&#x4E4B;&#x524D;&#x8FDB;&#x884C;&#x91CD;&#x65B0;&#x7ADE;&#x4E89;&#xFF0C;&#x5E76;&#x4E14;&#x6BCF;&#x4E2A;&#x91CD;&#x65B0;&#x4E89;&#x7528;&#x90FD;&#x53EF;&#x4EE5;&#x6BEB;&#x65E0;&#x504F;&#x5411;&#x5730;&#x6210;&#x529F;&#x62B5;&#x5FA1;&#x4F20;&#x5165;&#x7EBF;&#x7A0B;&#x3002;&#x540C;&#x6837;&#xFF0C;&#x5C3D;&#x7BA1;&#x83B7;&#x53D6;&#x4E0D;&#x662F;&#x901A;&#x5E38;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x65CB;&#x8F6C;&#xFF0C;&#x4F46;&#x5B83;&#x4EEC;&#x53EF;&#x80FD;&#x4F1A;&#x5728;&#x963B;&#x585E;&#x4E4B;&#x524D;&#x6267;&#x884C;{@code tryAcquire}&#x7684;&#x591A;&#x6B21;&#x8C03;&#x7528;&#xFF0C;&#x5E76;&#x63D2;&#x5165;&#x5176;&#x4ED6;&#x8BA1;&#x7B97;&#x3002;&#x5F53;&#x4EC5;&#x77ED;&#x6682;&#x5730;&#x4FDD;&#x6301;&#x6392;&#x4ED6;&#x540C;&#x6B65;&#x65F6;&#xFF0C;&#x8FD9;&#x5C06;&#x63D0;&#x4F9B;&#x65CB;&#x8F6C;&#x7684;&#x5927;&#x90E8;&#x5206;&#x597D;&#x5904;&#xFF0C;&#x800C;&#x5728;&#x4E0D;&#x8FDB;&#x884C;&#x6392;&#x4ED6;&#x540C;&#x6B65;&#x65F6;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x5E26;&#x6765;&#x5F88;&#x591A;&#x8D1F;&#x62C5;&#x3002;&#x5982;&#x679C;&#x9700;&#x8981;&#x7684;&#x8BDD;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5728;&#x8C03;&#x7528;&#x4E4B;&#x524D;&#x5BF9;&#x83B7;&#x53D6;&#x65B9;&#x6CD5;&#x8FDB;&#x884C;&#x201C;&#x5FEB;&#x901F;&#x8DEF;&#x5F84;&#x201D;&#x68C0;&#x67E5;&#x6765;&#x589E;&#x5F3A;&#x6B64;&#x529F;&#x80FD;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x9884;&#x5148;&#x68C0;&#x67E5;{@link #hasContended}&#x548C;/&#x6216;{@link #hasQueuedThreads}&#x4EE5;&#x4EC5;&#x5728;&#x540C;&#x6B65;&#x5668;&#x53EF;&#x80FD;&#x4E0D;&#x8FD9;&#x6837;&#x505A;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FD9;&#x6837;&#x505A;&#x4E89;&#x8FA9;&#x3002;

&#x8FD9;&#x4E2A;&#x7C7B;&#x4E3A;&#x540C;&#x6B65;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x548C;&#x53EF;&#x6269;&#x5C55;&#x7684;&#x57FA;&#x7840;&#xFF0C;&#x90E8;&#x5206;&#x662F;&#x901A;&#x8FC7;&#x5C06;&#x5B83;&#x7684;&#x4F7F;&#x7528;&#x8303;&#x56F4;&#x4E13;&#x95E8;&#x5316;&#x4E3A;&#x540C;&#x6B65;&#x5668;&#xFF0C;&#x8FD9;&#x4E9B;&#x540C;&#x6B65;&#x5668;&#x53EF;&#x4EE5;&#x4F9D;&#x8D56;&#x4E8E;{@code int}state&#x3001;&#x83B7;&#x53D6;&#x548C;&#x91CA;&#x653E;&#x53C2;&#x6570;&#xFF0C;&#x4EE5;&#x53CA;&#x4E00;&#x4E2A;&#x5185;&#x90E8;FIFO&#x7B49;&#x5F85;&#x961F;&#x5217;&#x3002;&#x5F53;&#x8FD9;&#x8FD8;&#x4E0D;&#x591F;&#x65F6;&#xFF0C;&#x60A8;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;{@link java.util.concurrent&#x4ECE;&#x8F83;&#x4F4E;&#x7684;&#x5C42;&#x6B21;&#x6784;&#x5EFA;&#x540C;&#x6B65;&#x5668;&#x3002;&#x539F;&#x5B50;&#x539F;&#x5B50;}&#x7C7B;&#xFF0C;&#x60A8;&#x81EA;&#x5DF1;&#x7684;&#x81EA;&#x5B9A;&#x4E49;{@link java.util&#x3002;&#x961F;&#x5217;}&#x7C7B;&#x548C;{@link LockSupport}&#x963B;&#x585E;&#x652F;&#x6301;&#x3002;
</code></pre><p>&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF1A;</p>
<p>&#x5168;&#x79F0;&#xFF1A;<code>AbstractQueuedSynchronizer</code> &#x62BD;&#x8C61;&#x7684;&#x961F;&#x5217;&#x5F0F;&#x540C;&#x6B65;&#x5668;&#xFF08;&#x62BD;&#x8C61;&#x7C7B;&#xFF09;&#x3002;&#x503C;&#x5F97;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x5B83;&#x4F7F;&#x7528;&#x7684;&#x662F;<strong><u>&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#x6A21;&#x5F0F;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;</u></strong>&#x3002;&#x641E;&#x6E05;&#x695A;&#x5B83;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5BF9;&#x7406;&#x89E3;&#x5B83;&#x7684;&#x6E90;&#x4EE3;&#x7801;&#x5F88;&#x6709;&#x5E2E;&#x52A9;&#x3002;</p>
<blockquote>
<p>&#x81EA;&#x5B9A;&#x4E49;&#x540C;&#x6B65;&#x5668;&#x5728;&#x5B9E;&#x73B0;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x9700;&#x8981;&#x5B9E;&#x73B0;&#x5171;&#x4EAB;&#x8D44;&#x6E90;state&#x7684;&#x83B7;&#x53D6;&#x548C;&#x91CA;&#x653E;&#x65B9;&#x5F0F;&#x5373;&#x53EF;&#xFF0C;&#x81F3;&#x4E8E;&#x5177;&#x4F53;&#x7EBF;&#x7A0B;&#x7B49;&#x5F85;&#x961F;&#x5217;&#x7684;&#x7EF4;&#x62A4;&#xFF0C;AQS&#x5DF2;&#x7ECF;&#x5728;&#x9876;&#x5C42;&#x5B9E;&#x73B0;&#x597D;&#x4E86;&#x3002;&#x81EA;&#x5B9A;&#x4E49;&#x540C;&#x6B65;&#x5668;&#x5B9E;&#x73B0;&#x7684;&#x65F6;&#x5019;&#x4E3B;&#x8981;&#x5B9E;&#x73B0;&#x4E0B;&#x9762;&#x51E0;&#x79CD;&#x65B9;&#x6CD5;&#xFF1A;
isHeldExclusively()&#xFF1A;&#x8BE5;&#x7EBF;&#x7A0B;&#x662F;&#x5426;&#x6B63;&#x5728;&#x72EC;&#x5360;&#x8D44;&#x6E90;&#x3002;&#x53EA;&#x6709;&#x7528;&#x5230;condition&#x624D;&#x9700;&#x8981;&#x53BB;&#x5B9E;&#x73B0;&#x5B83;&#x3002;
tryAcquire(int)&#xFF1A;&#x72EC;&#x5360;&#x65B9;&#x5F0F;&#x3002;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x8D44;&#x6E90;&#xFF0C;&#x6210;&#x529F;&#x5219;&#x8FD4;&#x56DE;true&#xFF0C;&#x5931;&#x8D25;&#x5219;&#x8FD4;&#x56DE;false&#x3002;
tryRelease(int)&#xFF1A;&#x72EC;&#x5360;&#x65B9;&#x5F0F;&#x3002;&#x5C1D;&#x8BD5;&#x91CA;&#x653E;&#x8D44;&#x6E90;&#xFF0C;&#x6210;&#x529F;&#x5219;&#x8FD4;&#x56DE;true&#xFF0C;&#x5931;&#x8D25;&#x5219;&#x8FD4;&#x56DE;false&#x3002;
tryAcquireShared(int)&#xFF1A;&#x5171;&#x4EAB;&#x65B9;&#x5F0F;&#x3002;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x8D44;&#x6E90;&#x3002;&#x8D1F;&#x6570;&#x8868;&#x793A;&#x5931;&#x8D25;&#xFF1B;0&#x8868;&#x793A;&#x6210;&#x529F;&#xFF0C;&#x4F46;&#x6CA1;&#x6709;&#x5269;&#x4F59;&#x53EF;&#x7528;&#x8D44;&#x6E90;&#xFF1B;&#x6B63;&#x6570;&#x8868;&#x793A;&#x6210;&#x529F;&#xFF0C;&#x4E14;&#x6709;&#x5269;&#x4F59;&#x8D44;&#x6E90;&#x3002;
tryReleaseShared(int)&#xFF1A;&#x5171;&#x4EAB;&#x65B9;&#x5F0F;&#x3002;&#x5C1D;&#x8BD5;&#x91CA;&#x653E;&#x8D44;&#x6E90;&#xFF0C;&#x5982;&#x679C;&#x91CA;&#x653E;&#x540E;&#x5141;&#x8BB8;&#x5524;&#x9192;&#x540E;&#x7EED;&#x7B49;&#x5F85;&#x7ED3;&#x70B9;&#x8FD4;&#x56DE;true&#xFF0C;&#x5426;&#x5219;&#x8FD4;&#x56DE;false&#x3002;</p>
</blockquote>
<p><strong><code>AQS</code> &#x7684;&#x6838;&#x5FC3;&#x601D;&#x60F3;</strong>&#x662F;&#xFF0C;&#x5982;&#x679C;&#x88AB;&#x8BF7;&#x6C42;&#x7684;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7A7A;&#x95F2;&#xFF0C;&#x5219;&#x5C06;&#x5F53;&#x524D;&#x8BF7;&#x6C42;&#x8D44;&#x6E90;&#x7684;&#x7EBF;&#x7A0B;&#x8BBE;&#x7F6E;&#x4E3A;&#x6709;&#x6548;&#x7684;&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#xFF0C;&#x5E76;&#x5C06;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x8BBE;&#x7F6E;&#x4E3A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x88AB;&#x8BF7;&#x6C42;&#x7684;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x88AB;&#x5360;&#x7528;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x4E00;&#x5957;&#x7EBF;&#x7A0B;&#x963B;&#x585E;&#x7B49;&#x5F85;&#x4EE5;&#x53CA;&#x88AB;&#x5524;&#x9192;&#x65F6;&#x9501;&#x5206;&#x914D;&#x7684;&#x673A;&#x5236;&#xFF0C;&#x8FD9;&#x4E2A;&#x673A;&#x5236; <code>AQS</code> &#x662F;&#x7528; <code>CLH</code> &#x961F;&#x5217;&#x9501;&#x5B9E;&#x73B0;&#x7684;&#xFF0C;&#x5373;&#x5C06;&#x6682;&#x65F6;&#x83B7;&#x53D6;&#x4E0D;&#x5230;&#x9501;&#x7684;&#x7EBF;&#x7A0B;&#x52A0;&#x5165;&#x5230;&#x961F;&#x5217;&#x4E2D;&#x3002;
<code>CLH&#xFF08;Craig&#xFF0C;Landin&#xFF0C;and Hagersten&#xFF09;</code>&#x961F;&#x5217;&#x662F;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7684;&#x53CC;&#x5411;&#x961F;&#x5217;&#xFF0C;&#x865A;&#x62DF;&#x7684;&#x53CC;&#x5411;&#x961F;&#x5217;&#x5373;&#x4E0D;&#x5B58;&#x5728;&#x961F;&#x5217;&#x5B9E;&#x4F8B;&#xFF0C;&#x4EC5;&#x5B58;&#x5728;&#x8282;&#x70B9;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x8054;&#x5173;&#x7CFB;&#x3002;
<strong><code>AQS</code> &#x662F;&#x5C06;&#x6BCF;&#x4E00;&#x6761;&#x8BF7;&#x6C42;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#x7684;&#x7EBF;&#x7A0B;&#x5C01;&#x88C5;&#x6210;&#x4E00;&#x4E2A; <code>CLH</code> &#x9501;&#x961F;&#x5217;&#x7684;&#x4E00;&#x4E2A;&#x7ED3;&#x70B9;&#xFF08;<code>Node</code>&#xFF09;&#xFF0C;&#x6765;&#x5B9E;&#x73B0;&#x9501;&#x7684;&#x5206;&#x914D;&#x3002;</strong></p>
<p>&#x7528;&#x5927;&#x767D;&#x8BDD;&#x6765;&#x8BF4;&#xFF0C;<code>AQS</code> &#x5C31;&#x662F;&#x57FA;&#x4E8E; <code>CLH</code> &#x961F;&#x5217;&#xFF0C;&#x7528; <code>volatile</code> &#x4FEE;&#x9970;&#x5171;&#x4EAB;&#x53D8;&#x91CF; <code>state</code>&#xFF0C;&#x7EBF;&#x7A0B;&#x901A;&#x8FC7; <code>CAS</code>&#x53BB;&#x6539;&#x53D8;&#x72B6;&#x6001;&#x7B26;&#xFF0C;&#x6210;&#x529F;&#x5219;&#x83B7;&#x53D6;&#x9501;&#x6210;&#x529F;&#xFF0C;&#x5931;&#x8D25;&#x5219;&#x8FDB;&#x5165;&#x7B49;&#x5F85;&#x961F;&#x5217;&#xFF0C;&#x7B49;&#x5F85;&#x88AB;&#x5524;&#x9192;&#x3002;</p>
<p><strong>&#x81EA;&#x65CB;&#x9501;&#x3001;&#x4E92;&#x65A5;&#x9501;&#x3001;&#x8BFB;&#x9501;&#x5199;&#x9501;&#x3001;&#x6761;&#x4EF6;&#x4EA7;&#x91CF;&#x3001;&#x4FE1;&#x53F7;&#x91CF;&#x3001;&#x6805;&#x680F;&#x90FD;&#x662F; <code>AQS</code> &#x7684;&#x884D;&#x751F;&#x7269;</strong></p>
<p>&#x4ECE;&#x4F7F;&#x7528;&#x5C42;&#x9762;&#x4E0A;&#x6765;&#x8BF4;&#x6709;&#x4E24;&#x79CD;&#x529F;&#x80FD;&#xFF1A;&#x72EC;&#x5360;&#x548C;&#x5171;&#x4EAB;</p>
<ul>
<li>&#x72EC;&#x5360;&#x9501;&#xFF0C;&#x6BCF;&#x6B21;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#x6301;&#x6709;&#x9501;&#xFF0C; <code>ReentrantLock</code> &#x5C31;&#x662F;&#x4EE5;&#x72EC;&#x5360;&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;&#x7684;&#x4E92;&#x65A5;&#x9501;&#x3002;</li>
<li>&#x5171;&#x4EAB;&#x9501;&#xFF0C;&#x5141;&#x8BB8;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x540C;&#x65F6;&#x83B7;&#x53D6;&#x9501;&#xFF0C;&#x5E76;&#x53D1;&#x8BBF;&#x95EE;&#x5171;&#x4EAB;&#x8D44;&#x6E90;&#xFF0C;&#x6BD4;&#x5982; <code>ReentrantReadWriteLock</code>&#x3001;<code>Semaphore</code>&#x3001;<code>CountDownLatch</code>&#x3001;<code>ReadWriteLock</code>&#x3001;<code>CyclicBarrier</code>&#x3002;</li>
</ul>
<h2 id="&#x6A21;&#x677F;&#x6A21;&#x5F0F;">&#x6A21;&#x677F;&#x6A21;&#x5F0F;</h2>
<p>&#x8FD9;&#x8FB9;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E0B;&#xFF1A;</p>
<p><u>&#x5728;&#x6A21;&#x677F;&#x6A21;&#x5F0F;&#xFF08;Template Pattern&#xFF09;&#x4E2D;&#xFF0C;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7C7B;&#x516C;&#x5F00;&#x5B9A;&#x4E49;&#x4E86;&#x6267;&#x884C;&#x5B83;&#x7684;&#x65B9;&#x6CD5;&#x7684;&#x65B9;&#x5F0F;/&#x6A21;&#x677F;&#x3002;&#x5B83;&#x7684;&#x5B50;&#x7C7B;&#x53EF;&#x4EE5;&#x6309;&#x9700;&#x8981;&#x91CD;&#x5199;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;&#xFF0C;&#x4F46;&#x8C03;&#x7528;&#x5C06;&#x4EE5;&#x62BD;&#x8C61;&#x7C7B;&#x4E2D;&#x5B9A;&#x4E49;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x3002;&#x8FD9;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x8BBE;&#x8BA1;&#x6A21;&#x5F0F;&#x5C5E;&#x4E8E;&#x884C;&#x4E3A;&#x578B;&#x6A21;&#x5F0F;&#x3002;</u></p>
<p><strong>&#x901A;&#x8FC7;&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x7B97;&#x6CD5;&#x9AA8;&#x67B6;&#xFF0C;&#x800C;&#x5C06;&#x7B97;&#x6CD5;&#x4E2D;&#x7684;&#x6B65;&#x9AA4;&#x5EF6;&#x8FDF;&#x5230;&#x5B50;&#x7C7B;&#xFF0C;&#x8FD9;&#x6837;&#x5B50;&#x7C7B;&#x5C31;&#x53EF;&#x4EE5;&#x590D;&#x5199;&#x8FD9;&#x4E9B;&#x6B65;&#x9AA4;&#x7684;&#x5B9E;&#x73B0;&#x6765;&#x5B9E;&#x73B0;&#x7279;&#x5B9A;&#x7684;&#x7B97;&#x6CD5;&#x3002;</strong></p>
<p>&#x662F;&#x7C7B;&#x7684;&#x4E00;&#x79CD;&#x884C;&#x4E3A;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x51C6;&#x5907;&#x4E00;&#x4E2A;&#x62BD;&#x8C61;&#x7C7B;&#xFF0C;&#x5C06;&#x903B;&#x8F91;&#x7528;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#x548C;&#x6784;&#x9020;&#x51FD;&#x6570;&#x7684;&#x5F62;&#x5F0F;&#x6765;&#x8868;&#x73B0;&#xFF0C;<strong>&#x540E;&#x58F0;&#x660E;&#x4E00;&#x4E9B;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x6765;&#x8FEB;&#x4F7F;&#x5B50;&#x7C7B;&#x5FC5;&#x987B;&#x5B9E;&#x73B0;&#x5176;&#x903B;&#x8F91;</strong>&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x5B50;&#x7C7B;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x4E0D;&#x540C;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4ECE;&#x800C;&#x53EF;&#x4EE5;&#x8BA9;&#x5269;&#x4F59;&#x7684;&#x903B;&#x8F91;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x5B9E;&#x73B0;&#x3002;&#x5373;&#x53EF;&#x4EE5;&#x5B9A;&#x4E49;&#x62BD;&#x8C61;&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x8BA9;&#x5B50;&#x7C7B;&#x5B9E;&#x73B0;&#x5269;&#x4F59;&#x7684;&#x903B;&#x8F91;&#x3002;</p>
<p>&#x4EE3;&#x7801;&#x793A;&#x4F8B;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Game</span> </span>{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">startPlay</span><span class="hljs-params">()</span></span>;

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">abstract</span> <span class="hljs-keyword">void</span> <span class="hljs-title">endPlay</span><span class="hljs-params">()</span></span>;

    <span class="hljs-comment">//&#x6A21;&#x677F; &#x7B97;&#x6CD5;&#x9AA8;&#x67B6; &#x5B50;&#x7C7B;&#x4E5F;&#x65E0;&#x6CD5;&#x91CD;&#x5199;&#x5176;&#x7B97;&#x6CD5;&#x903B;&#x8F91; &#x4F46;&#x662F;&#x5177;&#x4F53;&#x65B9;&#x6CD5;&#x7684;&#x903B;&#x8F91;&#x53EF;&#x4EE5;&#x4EA4;&#x7ED9;&#x5B50;&#x7C7B;&#x91CD;&#x5199;</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">play</span><span class="hljs-params">()</span> </span>{
        initialize();
        startPlay();
        endPlay();
    }
}
</code></pre>
<p>&#x5B50;&#x7C7B; <code>Cricket</code></p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Cricket</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Game</span> </span>{
   <span class="hljs-meta">@Override</span>
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">endPlay</span><span class="hljs-params">()</span> </span>{
      System.out.println(<span class="hljs-string">&quot;Cricket Game Finished!&quot;</span>);
   }

   <span class="hljs-meta">@Override</span>
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">initialize</span><span class="hljs-params">()</span> </span>{
      System.out.println(<span class="hljs-string">&quot;Cricket Game Initialized! Start playing.&quot;</span>);
   }

   <span class="hljs-meta">@Override</span>
   <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">startPlay</span><span class="hljs-params">()</span> </span>{
      System.out.println(<span class="hljs-string">&quot;Cricket Game Started. Enjoy the game!&quot;</span>);
   }
}
</code></pre>
<p>&#x8C03;&#x7528;&#xFF1A;</p>
<pre><code class="lang-java">Clicket  c = <span class="hljs-keyword">new</span> Clicket();
c.play();
</code></pre>
<p>&#x6BD4;&#x5982;&#x6E90;&#x7801;&#x4E2D;&#x7684;acquire&#x65B9;&#x6CD5;&#xFF08;&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#xFF09;&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">void</span> <span class="hljs-title">acquire</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span> </span>{
    <span class="hljs-keyword">if</span> (!tryAcquire(arg) &amp;&amp;
        acquireQueued(addWaiter(Node.EXCLUSIVE), arg))
        selfInterrupt();
}
</code></pre>
<p>&#x9996;&#x5148;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F; <code>final</code>&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x4E0D;&#x4F1A;&#x88AB;&#x5B50;&#x7C7B;&#x91CD;&#x5199;&#x7684;&#xFF0C;&#x518D;&#x770B;&#x770B;tryAcquire()</p>
<pre><code class="lang-java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryAcquire</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span> </span>{
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> UnsupportedOperationException();
}
</code></pre>
<p>&#x867D;&#x7136;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E0D;&#x662F; <code>abstract</code> &#x7684;&#xFF0C;&#x4F46;&#x662F;&#x4E5F;&#x80FD;&#x5F88;&#x6E05;&#x695A;&#x7684;&#x77E5;&#x9053;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x88AB;&#x5B50;&#x7C7B;&#x91CD;&#x5199;&#x903B;&#x8F91;&#xFF0C;&#x65B9;&#x6CD5;&#x91CC;&#x9762;&#x7684;&#x903B;&#x8F91;&#x53EF;&#x4EE5;&#x7531;&#x5404;&#x4E2A;&#x5B50;&#x7C7B;&#x6765;&#x91CD;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x4F46;&#x65B9;&#x6CD5;&#x7684;&#x8C03;&#x7528;&#x903B;&#x8F91;&#x662F;&#x7531;&#x7236;&#x7C7B;&#x8FD9;&#x8FB9;&#x6765;&#x64CD;&#x63A7;&#x7684;&#x3002;</p>
<p><code>acquire</code> &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x7684;&#x4E3B;&#x8981;&#x903B;&#x8F91;&#x662F;</p>
<ul>
<li>&#x901A;&#x8FC7; <code>tryAcquire</code> &#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x72EC;&#x5360;&#x9501;&#xFF0C;&#x5982;&#x679C;&#x6210;&#x529F;&#x8FD4;&#x56DE; <code>true</code>&#xFF0C;&#x5931;&#x8D25;&#x8FD4;&#x56DE; <code>false</code></li>
<li>&#x5982;&#x679C; <code>tryAcquire</code> &#x5931;&#x8D25;&#xFF0C;&#x5219;&#x4F1A;&#x901A;&#x8FC7; <code>addWaiter</code> &#x65B9;&#x6CD5;&#x5C06;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5C01;&#x88C5;&#x6210; <code>Node</code> &#x6DFB;&#x52A0;&#x5230; <code>AQS</code> &#x961F;&#x5217;&#x5C3E;&#x90E8;</li>
<li><code>acquireQueued</code>&#xFF0C;&#x5C06; <code>Node</code> &#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x901A;&#x8FC7;&#x81EA;&#x65CB;&#x53BB;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x9501;&#x3002;</li>
</ul>
<h2 id="&#x56DE;&#x5230;&#x540C;&#x6B65;&#x5668;">&#x56DE;&#x5230;&#x540C;&#x6B65;&#x5668;</h2>
<p>&#x540C;&#x6B65;&#x5668;&#x7684;&#x4E3B;&#x8981;&#x4F7F;&#x7528;&#x65B9;&#x5F0F;&#x662F;&#x7EE7;&#x627F;&#xFF0C;&#x5B50;&#x7C7B;&#x901A;&#x8FC7;&#x7EE7;&#x627F;&#x540C;&#x6B65;&#x5668;&#x5E76;&#x5B9E;&#x73B0;&#x5B83;&#x7684;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x6765;&#x7BA1;&#x7406;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x5728;&#x62BD;&#x8C61;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;&#x8FC7;&#x7A0B;&#x4E2D;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x4E8E;&#x662F;&#x6709; 3 &#x4E2A;&#x65B9;&#x6CD5;: <code>getState()&#x3001;setState(int newState)&#x3001;compareAndSetState(int expect,int update)</code>&#x3002;</p>
<blockquote>
<p>getState():&#x83B7;&#x53D6;&#x5F53;&#x524D;&#x540C;&#x6B65;&#x72B6;&#x6001;</p>
<p>setState(int newState):&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x540C;&#x6B65;&#x72B6;&#x6001;</p>
<p>compareAndSetState(int expect,int update):&#x4F7F;&#x7528; CAS &#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x72B6;&#x6001;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x80FD;&#x4FDD;&#x8BC1;&#x72B6;&#x6001;&#x8BBE;&#x7F6E;&#x7684;&#x539F;&#x5B50;&#x6027;</p>
</blockquote>
<ul>
<li><p>&#x548C;&#x9501;&#x4E4B;&#x95F4;&#x7684;&#x5173;&#x7CFB;</p>
<p>&#x540C;&#x6B65;&#x5668;&#x662F;&#x5B9E;&#x73B0;&#x9501;&#x7684;&#x5173;&#x952E;&#xFF0C;&#x5728;&#x9501;&#x7684;&#x5B9E;&#x73B0;&#x4E2D;&#x805A;&#x5408;&#x540C;&#x6B65;&#x5668;&#xFF0C;&#x5229;&#x7528;&#x540C;&#x6B65;&#x5668;&#x5B9E;&#x73B0;&#x9501;&#x7684;&#x8BED;&#x4E49;&#x3002;</p>
<p><strong>&#x9501;&#x662F;&#x9762;&#x5411;&#x4F7F;&#x7528;&#x8005;&#x7684;</strong>&#xFF0C;&#x5B83;&#x5B9A;&#x4E49;&#x4E86;&#x4F7F;&#x7528;&#x8005;&#x4E0E;&#x9501;&#x4EA4;&#x4E92;&#x7684;&#x63A5;&#x53E3;&#xFF08;&#x6BD4;&#x5982;&#x53EF;&#x4EE5;&#x5141;&#x8BB8;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x5E76;&#x884C;&#x8BBF;&#x95EE;&#xFF09;,&#x9690;&#x85CF;&#x4E86;&#x5B9E;&#x73B0;&#x7EC6;&#x8282;&#xFF1B;<strong>&#x540C;&#x6B65;&#x5668;&#x9762;&#x5411;&#x7684;&#x662F;&#x9501;&#x7684;&#x5B9E;&#x73B0;&#x8005;</strong>&#xFF0C;&#x4ED6;&#x7B80;&#x5316;&#x4E86;&#x9501;&#x7684;&#x5B9E;&#x73B0;&#x65B9;&#x5F0F;&#xFF0C;&#x5C4F;&#x853D;&#x4E86;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x7BA1;&#x7406;&#x3001;&#x7EBF;&#x7A0B;&#x7684;&#x6392;&#x961F;&#x3001;&#x7B49;&#x5F85;&#x4E8E;&#x5524;&#x9192;&#x7B49;&#x5E95;&#x5C42;&#x64CD;&#x4F5C;&#x3002;&#x7F29;&#x5408;&#x540C;&#x6B65;&#x5668;&#x5F88;&#x597D;&#x5730;&#x9694;&#x79BB;&#x4E86;&#x4F7F;&#x7528;&#x8005;&#x548C;&#x5B9E;&#x73B0;&#x8005;&#x6240;&#x9700;&#x5173;&#x6CE8;&#x7684;&#x9886;&#x57DF;&#x3002;</p>
</li>
</ul>
<p>&#x540C;&#x6B65;&#x5668;&#x4E2D;&#x53EF;&#x91CD;&#x5199;&#x7684;&#x65B9;&#x6CD5;&#xFF1A;</p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x65B9;&#x6CD5;&#x540D;&#x79F0;</th>
<th style="text-align:center">&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">protected boolean trtAcquire(int arg)</td>
<td style="text-align:center">&#x72EC;&#x5360;&#x5F0F;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x5B9E;&#x73B0;&#x8BE5;&#x65B9;&#x6CD5;&#x9700;&#x8981;&#x67E5;&#x8BE2;&#x5F53;&#x524D;&#x72B6;&#x6001;&#x5E76;&#x5224;&#x65AD;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x662F;&#x5426;&#x7B26;&#x5408;&#x9884;&#x671F;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8FDB;&#x884C; CAS &#x8BBE;&#x7F6E;&#x540C;&#x6B65;&#x72B6;&#x6001;</td>
</tr>
<tr>
<td style="text-align:center">protected boolean tryRelease(int arg)</td>
<td style="text-align:center">&#x72EC;&#x5360;&#x5F0F;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x7B49;&#x5F85;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x7684;&#x7EBF;&#x7A0B;&#x5C06;&#x6709;&#x673A;&#x4F1A;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;</td>
</tr>
<tr>
<td style="text-align:center">protected int tryAcquireShared(int arg)</td>
<td style="text-align:center">&#x5171;&#x4EAB;&#x5F0F;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x8FD4;&#x56DE;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;0&#x7684;&#x503C;&#xFF0C;&#x8868;&#x793A;&#x83B7;&#x53D6;&#x6210;&#x529F;&#xFF0C;&#x53CD;&#x4E4B;&#xFF0C;&#x83B7;&#x53D6;&#x5931;&#x8D25;</td>
</tr>
<tr>
<td style="text-align:center">protected boolean tryReleaseShared(int arg)</td>
<td style="text-align:center">&#x5171;&#x4EAB;&#x5F0F;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;</td>
</tr>
<tr>
<td style="text-align:center">protected boolean isHeldExclusively()</td>
<td style="text-align:center">&#x5F53;&#x524D;&#x540C;&#x6B65;&#x5668;&#x662F;&#x5426;&#x5728;&#x72EC;&#x5360;&#x6A21;&#x5F0F;&#x4E0B;&#x88AB;&#x7EBF;&#x7A0B;&#x5360;&#x7528;&#xFF0C;&#x4E00;&#x822C;&#x8BE5;&#x65B9;&#x6CD5;&#x8868;&#x793A;&#x662F;&#x5426;&#x88AB;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x6240;&#x5360;</td>
</tr>
</tbody>
</table>
<p>&#x4E0B;&#x9762;&#x662F;&#x540C;&#x6B65;&#x5668;&#x7684;&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#xFF1A;</p>
<table>
<thead>
<tr>
<th style="text-align:center">&#x65B9;&#x6CD5;&#x540D;&#x79F0;</th>
<th style="text-align:center">&#x63CF;&#x8FF0;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">final void acquire(int arg)</td>
<td style="text-align:center">&#x72EC;&#x5360;&#x5F0F;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x6210;&#x529F;&#xFF0C;&#x5219;&#x6539;&#x7531;&#x8BE5;&#x65B9;&#x6CD5;&#x8FD4;&#x56DE;&#xFF0C;&#x5426;&#x5219;&#xFF0C;&#x8FD8;&#x5C06;&#x4F1A;&#x8FDB;&#x5165;&#x540C;&#x6B65;&#x961F;&#x5217;&#x7B49;&#x5F85;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x8C03;&#x7528;&#x91CD;&#x5199;&#x7684; tryAcquire(int arg) &#x65B9;&#x6CD5;</td>
</tr>
<tr>
<td style="text-align:center">final void acquireInterruptibly(int arg)</td>
<td style="text-align:center">&#x4E0E; acquire &#x76F8;&#x540C;&#xFF0C;&#x5F53;&#x65F6;&#x8BE5;&#x65B9;&#x6CD5;&#x54CD;&#x5E94;&#x4E2D;&#x65AD;&#xFF0C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x672A;&#x83B7;&#x53D6;&#x5230;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x800C;&#x8FDB;&#x5165;&#x5230;&#x540C;&#x6B65;&#x961F;&#x5217;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x88AB;&#x4E2D;&#x65AD;&#xFF0C;&#x5219;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x629B;&#x51FA; InterruptedException &#x5E76;&#x8FD4;&#x56DE;</td>
</tr>
<tr>
<td style="text-align:center">final boolean tryAcquireNanos(int arg,long nanos)</td>
<td style="text-align:center">&#x5728; acquireinterruptibly &#x57FA;&#x7840;&#x4E0A;&#x589E;&#x52A0;&#x4E86;&#x8D85;&#x65F6;&#x9650;&#x5236;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x5728;&#x8D85;&#x65F6;&#x65F6;&#x95F4;&#x5185;&#x6CA1;&#x6709;&#x83B7;&#x53D6;&#x5230;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x90A3;&#x4E48;&#x4F1A;&#x8FD4;&#x56DE; false&#xFF0C;&#x5982;&#x679C;&#x83B7;&#x53D6;&#x5230;&#x4E86;&#x8FD4;&#x56DE; true</td>
</tr>
<tr>
<td style="text-align:center">final void acquireShared(int arg)</td>
<td style="text-align:center">&#x5171;&#x4EAB;&#x5F0F;&#x7684;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x5982;&#x679C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x672A;&#x83B7;&#x53D6;&#x5230;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x5C06;&#x4F1A;&#x8FDB;&#x5165;&#x540C;&#x6B65;&#x961F;&#x5217;&#x7B49;&#x5F85;&#xFF0C;&#x4E0E;&#x72EC;&#x5360;&#x5F0F;&#x83B7;&#x53D6;&#x7684;&#x4E3B;&#x8981;&#x533A;&#x522B;&#x662F;&#x5728;&#x540C;&#x4E00;&#x65F6;&#x523B;&#x53EF;&#x4EE5;&#x6709;&#x591A;&#x4E2A;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x5230;&#x540C;&#x6B65;&#x72B6;&#x6001;</td>
</tr>
<tr>
<td style="text-align:center">final void acquireSharedInterruptibly(int arg)</td>
<td style="text-align:center">&#x4E0E; acquireShared &#x76F8;&#x540C;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x54CD;&#x5E94;&#x4E2D;&#x65AD;</td>
</tr>
<tr>
<td style="text-align:center">final boolean tryAcquireSharedNanos(int arg,long nanos)</td>
<td style="text-align:center">&#x5728; acquireSharedInterruptibly&#x57FA;&#x7840;&#x4E0A;&#x589E;&#x52A0;&#x4E86;&#x8D85;&#x65F6;&#x9650;&#x5236;</td>
</tr>
<tr>
<td style="text-align:center">final boolean release(int arg)</td>
<td style="text-align:center">&#x72EC;&#x5360;&#x5F0F;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;&#xFF0C;&#x8BE5;&#x65B9;&#x6CD5;&#x4F1A;&#x5728;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x540C;&#x6B65;&#x961F;&#x5217;&#x4E2D;&#x7B2C;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x5305;&#x542B;&#x7684;&#x7EBF;&#x7A0B;&#x5524;&#x9192;</td>
</tr>
<tr>
<td style="text-align:center">final boolean releaseShared(int arg)</td>
<td style="text-align:center">&#x5171;&#x4EAB;&#x5F0F;&#x7684;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;</td>
</tr>
<tr>
<td style="text-align:center">final Collection\<thread> getQueuedThreads()</thread></td>
<td style="text-align:center">&#x83B7;&#x53D6;&#x7B49;&#x5F85;&#x5728;&#x540C;&#x6B65;&#x961F;&#x5217;&#x4E0A;&#x7684;&#x7EBF;&#x7A0B;&#x96C6;&#x5408;</td>
</tr>
</tbody>
</table>
<p>&#x6A21;&#x677F;&#x65B9;&#x6CD5;&#x57FA;&#x672C;&#x5206;&#x4E3A;3&#x7C7B;&#xFF1A;&#x72EC;&#x5360;&#x5F0F;&#x83B7;&#x53D6;&#x4E0E;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x3001;&#x5171;&#x4EAB;&#x5F0F;&#x83B7;&#x53D6;&#x4E0E;&#x91CA;&#x653E;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x3001;&#x67E5;&#x8BE2;&#x540C;&#x6B65;&#x961F;&#x5217;&#x4E2D;&#x7684;&#x7B49;&#x5F85;&#x7EBF;&#x7A0B;&#x72B6;&#x51B5;&#x3002;</p>
<h2 id="&#x5B9E;&#x73B0;&#x5206;&#x6790;">&#x5B9E;&#x73B0;&#x5206;&#x6790;</h2>
<p>&#x540C;&#x6B65;&#x5668;&#x4F9D;&#x8D56;&#x5185;&#x90E8;&#x7684;&#x540C;&#x6B65;&#x961F;&#x5217;&#xFF08;&#x4E00;&#x4E2A;FIFO&#x53CC;&#x5411;&#x961F;&#x5217;&#xFF09;&#x6765;&#x5B8C;&#x6210;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x7684;&#x7BA1;&#x7406;&#xFF0C;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x5931;&#x8D25;&#x65F6;&#xFF0C;&#x540C;&#x6B65;&#x5668;&#x4F1A;&#x5C06;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#x4EE5;&#x53CA;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x7B49;&#x4FE1;&#x606F;&#x6784;&#x9020;&#x6210;&#x4E3A;&#x4E00;&#x4E2A;&#x8282;&#x70B9;&#x5E76;&#x5C06;&#x5176;&#x52A0;&#x5165;&#x540C;&#x6B65;&#x961F;&#x5217;&#xFF0C;&#x540C;&#x65F6;&#x4F1A;&#x963B;&#x585E;&#x5F53;&#x524D;&#x7EBF;&#x7A0B;&#xFF0C;&#x5F53;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x91CA;&#x653E;&#x65F6;&#xFF0C;&#x4F1A;&#x628A;&#x9996;&#x8282;&#x70B9;&#x4E2D;&#x7684;&#x7EBF;&#x7A0B;&#x5524;&#x9192;&#xFF0C;&#x4F7F;&#x5176;&#x518D;&#x6B21;&#x5C1D;&#x8BD5;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x3002;&#x3002;</p>
<blockquote>
<p>&#x8282;&#x70B9;&#x7528;&#x6765;&#x4FDD;&#x5B58;&#x83B7;&#x53D6;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x5931;&#x8D25;&#x7684;&#x7EBF;&#x7A0B;&#x5F15;&#x7528;&#x3001;&#x7B49;&#x5F85;&#x72B6;&#x6001;&#x8BB0;&#x5FC6;&#x524D;&#x9A71;&#x548C;&#x540E;&#x7EE7;&#x8282;&#x70B9;&#x3002;</p>
</blockquote>
<p><img src="http://www.qxnekoo.cn:8888/images/2020/05/11/AQS_QUEUE.png" alt="AQS_QUEUE.png"></p>
<p>&#x83B7;&#x53D6;&#x9501;&#x7684;&#x6D41;&#x7A0B;&#xFF1A;</p>
<p><img src="http://www.qxnekoo.cn:8888/images/2020/05/11/AQS_PROCEDURE.png" alt="AQS_PROCEDURE.png"></p>
<p>&#x4E0B;&#x9762;&#x4E3E;&#x51E0;&#x4E2A;&#x4F8B;&#x5B50;&#x5427;&#xFF0C;&#x9996;&#x5148;&#x662F; <code>Mutex</code>&#xFF0C;&#x8FD9;&#x4E2A;&#x4E5F;&#x662F;&#x6E90;&#x7801;&#x6CE8;&#x91CA;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;</p>
<blockquote>
<p>&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x4E0D;&#x53EF;&#x91CD;&#x5165;&#x7684;&#x4E92;&#x65A5;&#x9501;&#x7C7B;&#xFF0C;&#x5B83;&#x4F7F;&#x7528;&#x503C;0&#x8868;&#x793A;&#x89E3;&#x9501;&#x72B6;&#x6001;&#xFF0C;&#x4F7F;&#x7528;&#x503C;1&#x8868;&#x793A;&#x9501;&#x5B9A;&#x72B6;&#x6001;&#x3002;&#x867D;&#x7136;&#x975E;&#x91CD;&#x5165;&#x9501;&#x5E76;&#x4E0D;&#x4E25;&#x683C;&#x8981;&#x6C42;&#x8BB0;&#x5F55;&#x5F53;&#x524D;&#x6240;&#x6709;&#x8005;&#x7EBF;&#x7A0B;&#xFF0C;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x7C7B;&#x8FD9;&#x6837;&#x505A;&#x662F;&#x4E3A;&#x4E86;&#x4F7F;&#x4F7F;&#x7528;&#x66F4;&#x5BB9;&#x6613;&#x76D1;&#x63A7;&#x3002;&#x5B83;&#x8FD8;&#x652F;&#x6301; condition&#xFF0C;&#x5E76;&#x516C;&#x5F00;&#x5176;&#x4E2D;&#x4E00;&#x79CD;instrumentation &#x7684;&#x65B9;&#x6CD5;:</p>
</blockquote>
<pre><code class="lang-java">
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Mutex</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Lock</span>, <span class="hljs-title">java</span>.<span class="hljs-title">io</span>.<span class="hljs-title">Serializable</span> </span>{
    <span class="hljs-comment">//&#x540C;&#x6B65;&#x5668; &#x4F7F;&#x7528;&#x5185;&#x90E8;&#x9759;&#x6001;&#x7C7B;</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractQueuedSynchronizer</span> </span>{
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">isHeldExclusively</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> getState() == <span class="hljs-number">1</span>;
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryAcquire</span><span class="hljs-params">(<span class="hljs-keyword">int</span> acquires)</span> </span>{
            <span class="hljs-keyword">if</span> (compareAndSetState(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)) {
                setExclusiveOwnerThread(Thread.currentThread());
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
        }
        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryRelease</span><span class="hljs-params">(<span class="hljs-keyword">int</span> release)</span> </span>{
            <span class="hljs-keyword">if</span> (getState() == <span class="hljs-number">0</span>)
                setExclusiveOwnerThread(<span class="hljs-keyword">null</span>);
            setState(<span class="hljs-number">0</span>);
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
        }

        <span class="hljs-function">Condition <span class="hljs-title">newCondition</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ConditionObject();
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">readObject</span><span class="hljs-params">(ObjectInputStream s)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException </span>{
            s.defaultReadObject();
            setState(<span class="hljs-number">0</span>);
        }
    }

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Sync sync = <span class="hljs-keyword">new</span> Sync();

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>{
        sync.acquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lockInterruptibly</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> InterruptedException </span>{
        sync.acquireInterruptibly(<span class="hljs-number">1</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> sync.tryAcquire(<span class="hljs-number">1</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryLock</span><span class="hljs-params">(<span class="hljs-keyword">long</span> time, TimeUnit unit)</span> <span class="hljs-keyword">throws</span> InterruptedException </span>{
        <span class="hljs-keyword">return</span> sync.tryAcquireNanos(<span class="hljs-number">1</span>, unit.toNanos(time));
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>{
        sync.release(<span class="hljs-number">1</span>);
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Condition <span class="hljs-title">newCondition</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> sync.newCondition();
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">hasQueuedThreads</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> sync.hasQueuedThreads();
    }
}
</code></pre>
<p>&#x8FD8;&#x6709;&#x4E00;&#x4E2A;&#x53EF;&#x5171;&#x4EAB;&#x7684;&#x4F8B;&#x5B50;(&#x540C;&#x65F6;&#x53EA;&#x80FD;&#x6709;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#x80FD;&#x591F;&#x83B7;&#x5F97;&#x9501;)&#xFF1A;</p>
<pre><code class="lang-java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TwinsLock</span> </span>{

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Sync</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractQueuedSynchronizer</span> </span>{
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Sync</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.setState(<span class="hljs-number">2</span>);
        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">int</span> <span class="hljs-title">tryAcquireShared</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span> </span>{
            <span class="hljs-comment">//return super.tryAcquireShared(arg);</span>
            <span class="hljs-keyword">for</span> (; ; ) {
                <span class="hljs-keyword">int</span> newState = getState() - arg;
                <span class="hljs-keyword">if</span> (newState &lt; <span class="hljs-number">0</span> || compareAndSetState(getState(), newState)) {
                    <span class="hljs-keyword">return</span> newState;
                }
            }

        }

        <span class="hljs-meta">@Override</span>
        <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">tryReleaseShared</span><span class="hljs-params">(<span class="hljs-keyword">int</span> arg)</span> </span>{
            <span class="hljs-comment">//return super.tryReleaseShared(arg);</span>
            <span class="hljs-keyword">for</span> (; ; ) {
                <span class="hljs-keyword">int</span> newState = getState() + arg;
                <span class="hljs-keyword">if</span> (compareAndSetState(getState(), newState)) {
                    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;
                }
            }
        }
    }

    <span class="hljs-keyword">private</span> Sync sync = <span class="hljs-keyword">new</span> Sync();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">lock</span><span class="hljs-params">()</span> </span>{
        sync.acquireShared(<span class="hljs-number">1</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">unlock</span><span class="hljs-params">()</span> </span>{
        sync.releaseShared(<span class="hljs-number">1</span>);
    }
}
</code></pre>
<p><code>AQS</code> &#x7684;&#x5185;&#x5BB9;&#x786E;&#x5B9E;&#x590D;&#x6742;&#x96BE;&#x61C2;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x6E90;&#x7801;&#xFF0C;&#x4EE5;&#x540E;&#x518D;&#x6765;&#x8865;&#x5145;&#x5427;&#x3002;(&#x76EE;&#x524D;&#x6211;&#x77E5;&#x9053;&#x7684;&#x662F; tryAcquire &#x548C; tryRelease &#x8FD4;&#x56DE; true&#x662F;&#x4EE3;&#x8868;&#x62A2;&#x5360;&#x6210;&#x529F;&#x3001;&#x91CA;&#x653E;&#x6210;&#x529F;&#x3002;&#x8FD8;&#x4E0D;&#x77E5;&#x9053;&#x5BF9;&#x4E0D;&#x5BF9;)</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="等待-通知机制.html" class="navigation navigation-prev " aria-label="Previous page: 等待-通知机制">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../Basic/" class="navigation navigation-next " aria-label="Next page: 基础/高级">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"AQS","level":"1.3.11","depth":2,"next":{"title":"基础/高级","level":"1.4","depth":1,"path":"Basic/README.md","ref":"Basic/README.md","articles":[{"title":"java中的序列化","level":"1.4.1","depth":2,"path":"Basic/java中的序列化.md","ref":"Basic/java中的序列化.md","articles":[]},{"title":"反射","level":"1.4.2","depth":2,"path":"Basic/反射.md","ref":"Basic/反射.md","articles":[]},{"title":"动态代理","level":"1.4.3","depth":2,"path":"Basic/动态代理.md","ref":"Basic/动态代理.md","articles":[]},{"title":"函数式编程","level":"1.4.4","depth":2,"path":"Basic/函数式编程.md","ref":"Basic/函数式编程.md","articles":[]},{"title":"stream流","level":"1.4.5","depth":2,"path":"Basic/stream.md","ref":"Basic/stream.md","articles":[]},{"title":"父子类中的初始化顺序","level":"1.4.6","depth":2,"path":"Basic/父子类中的初始化顺序.md","ref":"Basic/父子类中的初始化顺序.md","articles":[]},{"title":"值传递还是引用传递","level":"1.4.7","depth":2,"path":"Basic/值传递和引用传递.md","ref":"Basic/值传递和引用传递.md","articles":[]},{"title":"单例模式","level":"1.4.8","depth":2,"path":"Basic/单例模式.md","ref":"Basic/单例模式.md","articles":[]},{"title":"接口和抽象类","level":"1.4.9","depth":2,"path":"Basic/接口和抽象类.md","ref":"Basic/接口和抽象类.md","articles":[]},{"title":"ConcurrentHashMap","level":"1.4.10","depth":2,"path":"Basic/ConcurrentHashMap.md","ref":"Basic/ConcurrentHashMap.md","articles":[]},{"title":"SPI","level":"1.4.11","depth":2,"path":"Basic/SPI.md","ref":"Basic/SPI.md","articles":[]},{"title":"位运算","level":"1.4.12","depth":2,"path":"Basic/位运算.md","ref":"Basic/位运算.md","articles":[]}]},"previous":{"title":"等待-通知机制","level":"1.3.10","depth":2,"path":"Concurrent/等待-通知机制.md","ref":"Concurrent/等待-通知机制.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["expandable-chapters"],"pluginsConfig":{"expandable-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Concurrent/AQS.md","mtime":"2020-05-12T16:12:21.377Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-05-31T03:21:00.459Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

