# 类变量和Class对象存放的区域

> 2020/4/1

先说结论：

`JDK7`之后及其以后的版本的`HotSpot`虚拟机选择把静态变量和`Java`类的`Class`对象存放在一起，**存储与`Java`堆中**。换句话说，**`JDK8` 中，两者都位于堆（Heap），且static 成员变量位于 Class对象内。**

字符串常量池也是放在堆中的。

![795e3782f39e2f9eb500e3940470a897.png](http://www.qxnekoo.cn:8888/images/2020/04/14/795e3782f39e2f9eb500e3940470a897.png)

当调用 `intern` 方法时，**如果池已经包含一个等于此String对象的字符串（用 `equals(oject)` 方法确定），则返回池中的字符串。否则，将此 `String` 对象添加到池中，并返回此 `String` 对象的引用。**



那么`jdk`中的元空间是用来干嘛的？

元空间的出现就是为了解决突出的类和类加载器元数据过多导致的`OOM`问题，而从`jdk7`中开始永久代经过对方法区的分裂后已经几乎只存储类和类加载器的元数据(不是`Class`对象，可能是一串二进制字节流)信息了，到了`jdk8`，元空间中也是存储这些信息。

在`Java8`中，元空间(`Metaspace`)登上舞台，方法区存在于元空间(`Metaspace`)。同时，元空间不再与堆连续，而且是存在于本地内存（`Native memory`）。

本地内存（`Native memory`），也称为`C-Heap`，是供`JVM`自身进程使用的。当`Java Heap`空间不足时会触发`GC`，但`Native memory`空间不够却不会触发`GC`。