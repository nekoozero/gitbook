# HotSpot 中的编译器与解释器

> 时间：2020/4/14  
>
> 以后决定将写这些的时间全部更新上去，以记录自己的成长吧。

- 编译器在编译的过程中，读入源程序文件，输出一份等价的二进制可执行文件，就和笔译工作者一样，他们都会输出一份翻译后的文件。
- 解释器在解释的过程中，读入源程序文件，输出的是执行的结果，就和口译工作者一样，他们输出的是已经完成翻译的结果。

**输出的不同是这两者最大的区别，一个会输出用于执行的文件，另一个只会输出运行的结果；**

**解释型语言启动速度快，但启动后的运行效率不高，而编译型语言启动速度慢，但启动后运行效率高，这也是两者一个极大的区别。**

特点：

- 解释器：跨平台、启动速度快、开发效率高。但是执行速度慢，执行效率低。
- 编译器：执行速度快、执行效率高。但是平台相关性高，编译速度（启动速度）慢，开发效率低。

`Java` 中编译器比较多，它包含*一个前端编译器，一个后端编译器（`JIT`）以及一个静态预编译器（`AOT`）*。

- 前端编译器的功能是从源代码生成 `Java` 字节码，也就是中间代码；
- 后端编译器，也叫作即时编译器（`JIT`）它是包含在了 `JVM` 中，用于在执行的过程中，将热点代码（也就是执行次数比较多的代码）转化为本地机器码，并做一些优化，以加速执行效率。
- 静态预编译器（`AOT`）它是直接将 `java` 源代码编译成本地机器码，也就是传统意义上的编译器，但用的不多，因为这样会使 `java` 的一些特性丢失。

## 编译器

`JVM`中包含一个解释器和多个编译器，在目前阶段，主流的编译分为前端编译和后端编译。后端编译虽然这不是`JVM`虚拟机的规范，但是这些都是衡量一个高质量虚拟机的指标之一。

对性能的优化都是在后端编译上的。开发阶段的优化（比如说语法糖）都是在前端编译体现的。可以这样说：**后端编译是运行期的优化过程，支撑了程序执行效率的不断提升；而前端编译器在编译期的优化过程，则是支撑程序员的编码效率。**

![18c1d2566427e48a20f998eba57daf03.png](http://www.qxnekoo.cn:8888/images/2020/04/14/18c1d2566427e48a20f998eba57daf03.png)

前端编译的最终产物是`中间代码`，这个中间代码所指的就是`Java`的字节码文件。但是这个文件还是不能被处理器运行的能力，还需要一层`JVM`的加工。

## 解释器

解释器顾名思义就是解释代码用的，上面提到了前端编译的最终产物是中间代码，这时的中间代码不具有被处理器识别并执行的能力，解释器的职责就是将此时的字节码**逐条解释**成处理器能够识别的机器码指令。

所以从这里也可以解释，为什么高级语言执行效率会这么慢，主要就是多了这个解释的过程，像 `Java`、`Python` 等执行效率都比较慢。

所以通俗讲：解释器在 `Java` 中的作用充当了 `Java` 程序和计算机之间的“翻译官”角色，将计算机“看”不懂的语言翻译成它能够“看”懂并执行的机器语言。

`Java` 中的解释器与 `JIT` (后端编译)一起打包，作为 `JVM` 中的*执行引擎*，解释器主要将字节码进行解释执行，同时配合 `JIT` 进行代码的优化操作。

> 当程序需要迅速启动和执行的时候，解释器可以首先发挥作用，省去编译的时间，立即运行。当程序启动之后，随着时间的推移，编译器逐渐发挥作用，把越来越多的代码编译成本地代码，可以减少解释器的中间损耗，获得更高的执行效率。

![JIT.png](http://www.qxnekoo.cn:8888/images/2020/04/14/JIT.png)

后续会大概记录一下 `JIT` 技术具体的优化策略。

参考文章：https://www.jianshu.com/p/96d65e8f4cbf

​                   https://zhuanlan.zhihu.com/p/107382276

​                   https://blog.csdn.net/qq_34812009/article/details/89020419



